pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
#include piece.lua
#include world.lua
#include ui.lua

function _init()
    DEBUG = false
    frame_timer = 0
    mode = "playing"
    world = World:new()
end

function _update()
    if mode == "playing" then
        world:update_world()
        update_ui()

        if world.state == WORLD_STATE.GAME_OVER and btnp(4) then
            world = World:new()
        end
    elseif mode == "menu" then
        update_menu()
    end

    -- transition:update()
    frame_timer += 1
end

function _draw()
    cls(0)
    if mode == "playing" then
        world:draw_world()
        draw_ui()
    elseif mode == "menu" then
        draw_menu()
    end

    -- if transition.active then transition:draw() end
    print_debug()
end

function debug(str)
    add(debug_list, str)
end

function print_debug()
    for d in all(debug_list) do
        print(d)
    end
    debug_list = {}
end

__gfx__
00000000000000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000011c10ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070001ccc0ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000ccc10ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700001c110ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000ffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000ffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
